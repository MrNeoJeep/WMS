"use strict";(self["webpackChunkwms_web"]=self["webpackChunkwms_web"]||[]).push([[813],{813:function(e,t,o){o.r(t),o.d(t,{default:function(){return m}});var a=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{"margin-bottom":"5px"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名字","suffix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadPost.apply(null,arguments)}},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t("el-select",{staticStyle:{"margin-left":"5px"},attrs:{filterable:"",placeholder:"请选择性别"},model:{value:e.sex,callback:function(t){e.sex=t},expression:"sex"}},e._l(e.sexs,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:e.loadPost}},[e._v("查询")]),t("el-button",{attrs:{type:"success"},on:{click:e.resetParam}},[e._v("重置")]),t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")])],1),t("el-table",{attrs:{data:e.tableData,"header-cell-style":{background:"#f2f5fc",color:"#555555"},border:""}},[t("el-table-column",{attrs:{prop:"id",label:"ID",width:"60"}}),t("el-table-column",{attrs:{prop:"no",label:"账号",width:"180"}}),t("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"}}),t("el-table-column",{attrs:{prop:"age",label:"年龄",width:"80"}}),t("el-table-column",{attrs:{prop:"sex",label:"性别",width:"80"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-tag",{attrs:{type:1===o.row.sex?"primary":"success","disable-transitions":""}},[e._v(e._s(1===o.row.sex?"男":"女"))])]}}])}),t("el-table-column",{attrs:{prop:"roleId",label:"角色",width:"100"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-tag",{attrs:{type:0===o.row.roleId?"danger":1===o.row.roleId?"primary":"success","disable-transitions":""}},[e._v(e._s(0===o.row.roleId?"超级管理员":1===o.row.roleId?"管理员":"用户"))])]}}])}),t("el-table-column",{attrs:{prop:"phone",label:"电话",width:"150"}}),t("el-table-column",{attrs:{prop:"operate",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-button",{attrs:{size:"small",type:"success"},on:{click:function(t){return e.mod(o.row)}}},[e._v("编辑")]),t("el-popconfirm",{staticStyle:{"margin-left":"5px"},attrs:{title:"确定删除吗？"},on:{confirm:function(t){return e.del(o.row.id)}}},[t("el-button",{attrs:{slot:"reference",size:"small",type:"danger"},slot:"reference"},[e._v("删除")])],1),t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"Y"===o.row.isValid?"primary":"danger",size:"small"},on:{click:function(t){return e.doAllow(o.row)}},scopedSlots:e._u(["Y"===o.row.isValid?{key:"default",fn:function(){return[e._v("禁用")]},proxy:!0}:{key:"default",fn:function(){return[e._v("启用")]},proxy:!0}],null,!0)})]}}])})],1),t("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[5,10,20,30],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("el-dialog",{attrs:{title:"提示",visible:e.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[t("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"账号",prop:"no"}},[t("el-col",{attrs:{span:20}},[t("el-input",{model:{value:e.form.no,callback:function(t){e.$set(e.form,"no",t)},expression:"form.no"}})],1)],1),t("el-form-item",{attrs:{label:"名字",prop:"name"}},[t("el-col",{attrs:{span:20}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-col",{attrs:{span:20}},[t("el-input",{attrs:{type:"password","show-password":"",autocomplete:"off"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),t("el-form-item",{attrs:{label:"年龄",prop:"age"}},[t("el-col",{attrs:{span:20}},[t("el-input",{model:{value:e.form.age,callback:function(t){e.$set(e.form,"age",t)},expression:"form.age"}})],1)],1),t("el-form-item",{attrs:{label:"性别"}},[t("el-radio-group",{model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[t("el-radio",{attrs:{label:"1"}},[e._v("男")]),t("el-radio",{attrs:{label:"0"}},[e._v("女")])],1)],1),t("el-form-item",{attrs:{label:"电话",prop:"phone"}},[t("el-col",{attrs:{span:20}},[t("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveAdd}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"提示",visible:e.centerDialogVisibleEdit,width:"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisibleEdit=t}}},[t("el-form",{ref:"form1",attrs:{rules:e.rules,model:e.form1,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"账号",prop:"no"}},[t("el-col",{attrs:{span:20}},[t("el-input",{attrs:{readonly:""},model:{value:e.form1.no,callback:function(t){e.$set(e.form1,"no",t)},expression:"form1.no"}})],1)],1),t("el-form-item",{attrs:{label:"名字",prop:"name"}},[t("el-col",{attrs:{span:20}},[t("el-input",{model:{value:e.form1.name,callback:function(t){e.$set(e.form1,"name",t)},expression:"form1.name"}})],1)],1),t("el-form-item",{attrs:{label:"年龄",prop:"age"}},[t("el-col",{attrs:{span:20}},[t("el-input",{model:{value:e.form1.age,callback:function(t){e.$set(e.form1,"age",t)},expression:"form1.age"}})],1)],1),t("el-form-item",{attrs:{label:"性别"}},[t("el-radio-group",{model:{value:e.form1.sex,callback:function(t){e.$set(e.form1,"sex",t)},expression:"form1.sex"}},[t("el-radio",{attrs:{label:"1"}},[e._v("男")]),t("el-radio",{attrs:{label:"0"}},[e._v("女")])],1)],1),t("el-form-item",{attrs:{label:"电话",prop:"phone"}},[t("el-col",{attrs:{span:20}},[t("el-input",{model:{value:e.form1.phone,callback:function(t){e.$set(e.form1,"phone",t)},expression:"form1.phone"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.centerDialogVisibleEdit=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveMod}},[e._v("确 定")])],1)],1)],1)},s=[],r=(o(1703),{name:"UserManage",data(){let e=(e,t,o)=>{t>150?o(new Error("年龄输入过大")):o()},t=(e,t,o)=>{if(this.form.id)return o();this.$axios.get("/user/findByNo?no="+this.form.no,{headers:{Authorization:localStorage.getItem("token")}}).then((e=>e.data)).then((e=>{console.log(e),200!=e.code?o():o(new Error("账号已经存在"))}))};return{tableData:[],pageSize:10,pageNum:1,total:0,name:"",sex:"",sexs:[{value:"1",label:"男"},{value:"0",label:"女"}],centerDialogVisible:!1,form:{id:"",no:"",name:"",password:"",age:"",phone:"",sex:"1",roleId:"2",isValid:"Y"},centerDialogVisibleEdit:!1,form1:{id:"",no:"",name:"",age:"",phone:"",sex:"0"},rules:{no:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:8,message:"长度在 3 到 8 个字符",trigger:"blur"},{validator:t,trigger:"blur"}],name:[{required:!0,message:"请输入名字",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:3,max:8,message:"长度在 3 到 8 个字符",trigger:"blur"}],age:[{required:!0,message:"请输入年龄",trigger:"blur"},{min:1,max:3,message:"长度在 1 到 3 个位",trigger:"blur"},{pattern:/^([1-9][0-9]*){1,3}$/,message:"年龄必须为正整数字",trigger:"blur"},{validator:e,trigger:"blur"}],phone:[{required:!0,message:"手机号不能为空",trigger:"blur"},{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}}},methods:{doAllow(e){console.log(e),"Y"==e.isValid?e.isValid="N":e.isValid="Y",this.$axios.get("/user/changeState?id="+e.id,{headers:{Authorization:localStorage.getItem("token")}}).then((e=>e.data)).then((e=>{console.log(e),200==e.code?this.$message({message:"操作成功！",type:"success"}):this.$message({message:"操作失败！",type:"error"})}))},resetForm(){this.$refs.form.resetFields()},resetEditForm(){this.$refs.form1.resetFields()},del(e){console.log(e),this.$axios.get("/user/del?id="+e,{headers:{Authorization:localStorage.getItem("token")}}).then((e=>e.data)).then((e=>{console.log(e),200==e.code?(this.$message({message:"操作成功！",type:"success"}),this.loadPost()):this.$message({message:"操作失败！",type:"error"})}))},mod(e){console.log(e),this.centerDialogVisibleEdit=!0,this.$nextTick((()=>{this.form1.id=e.id,this.form1.no=e.no,this.form1.name=e.name,this.form1.age=e.age+"",this.form1.sex=e.sex+"",this.form1.phone=e.phone}))},add(){this.centerDialogVisible=!0,this.$nextTick((()=>{this.resetForm()}))},doSave(){this.$axios.post("/user/save",this.form,{headers:{Authorization:localStorage.getItem("token")}}).then((e=>e.data)).then((e=>{console.log(e),200==e.code?(this.$message({message:"操作成功！",type:"success"}),this.centerDialogVisible=!1,this.loadPost(),this.resetForm()):this.$message({message:"操作失败！",type:"error"})}))},doMod(){this.$axios.post("/user/update",this.form1,{headers:{Authorization:localStorage.getItem("token")}}).then((e=>e.data)).then((e=>{console.log(e),200==e.code?(this.$message({message:"操作成功！",type:"success"}),this.centerDialogVisibleEdit=!1,this.loadPost(),this.resetEditForm()):this.$message({message:"操作失败！",type:"error"})}))},saveAdd(){this.$refs.form.validate((e=>{if(!e)return console.log("error submit!!"),!1;this.form.id||this.doSave()}))},saveMod(){this.$refs.form1.validate((e=>{if(!e)return console.log("error submit!!"),!1;this.form1.id&&this.doMod()}))},handleSizeChange(e){console.log(`每页 ${e} 条`),this.pageNum=1,this.pageSize=e,this.loadPost()},handleCurrentChange(e){console.log(`当前页: ${e}`),this.pageNum=e,this.loadPost()},loadGet(){this.$axios.get("/user/list",{headers:{Authorization:localStorage.getItem("token")}}).then((e=>e.data)).then((e=>{console.log(e)}))},resetParam(){this.name="",this.sex=""},loadPost(){this.$axios.post("/user/listPageC1",{pageSize:this.pageSize,pageNum:this.pageNum,param:{name:this.name,sex:this.sex,roleId:"2"}},{headers:{Authorization:localStorage.getItem("token")}}).then((e=>e.data)).then((e=>{console.log(e),200==e.code?(this.tableData=e.data,this.total=e.total):alert("获取数据失败")}))}},beforeMount(){this.loadPost()}}),l=r,i=o(1001),n=(0,i.Z)(l,a,s,!1,null,"1bc9e39d",null),m=n.exports}}]);
//# sourceMappingURL=813.50453d81.js.map